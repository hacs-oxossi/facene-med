<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#f9fafb" id="theme-color-meta" />
  <title>C√°lculo de M√©dia Ponderada - M√≥dulos Acad√™micos</title>
  <style>
    :root {
      --bg:#f0f6ff; --fg:#111827; --primary:#2563eb; --primary-700:#1d4ed8;
      --card:#ffffff; --mod:#e0f2fe; --index:#dbeafe; --ok:#10b981; --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    body{font-family:'Segoe UI',Arial,sans-serif;background:var(--bg);color:var(--fg);
      margin:20px auto;max-width:1000px;padding:0 10px;transition:background .3s,color .3s;}
    h1,h2,h3{text-align:center;}h3{margin:6px 0 10px;font-size:clamp(1rem,2.4vw,1.15rem);} 

    .toggle-theme{display:flex;justify-content:center;margin-bottom:12px;}
    .toggle-theme button{background:var(--primary);color:#fff;border:0;padding:8px 14px;border-radius:6px;cursor:pointer;}
    .toggle-theme button:hover{background:var(--primary-700);} 

    .indice{background:var(--index);padding:10px;border-radius:8px;margin-bottom:16px;text-align:center;}
    .indice a{display:inline-block;color:var(--primary-700);text-decoration:none;margin:4px 8px;font-weight:600;}

    .modulo{background:var(--mod);border-radius:10px;padding:18px;margin-bottom:22px;box-shadow:0 2px 10px rgba(0,0,0,0.05);} 
    .unidade{background:var(--card);border-radius:8px;padding:12px;margin-top:10px;box-shadow:0 1px 6px rgba(0,0,0,0.05);} 
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px 16px;}
    label{display:flex;flex-direction:column;font-size:clamp(.9rem,2vw,1rem);} 
    input{width:100%;padding:8px;margin-top:4px;border-radius:6px;border:1px solid #cbd5e1;font-size:1rem;} 

    .actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;}
    button.calc-btn,button.clear-btn{background-color:var(--primary);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;width:100%;font-size:1rem;} 
    button.clear-btn{background-color:#6b7280;} 
    button.calc-btn:hover{background-color:var(--primary-700);} 
    button.clear-btn:hover{background-color:#4b5563;} 

    .resultado{font-weight:700;margin-top:8px;text-align:center;}
    .mensagem{text-align:center;font-size:clamp(.85rem,2vw,1rem);} 
    .mensagem.warn{color:var(--warn);} .mensagem.ok{color:var(--ok);} .final{color:var(--ok);} 

    @media(max-width:768px){
      body{margin:10px;padding:0 5px;} .modulo{padding:14px;} .unidade{padding:10px;}
      .grid{grid-template-columns:1fr;} .actions{grid-template-columns:1fr;} .indice a{display:block;margin:6px 0;}
    }

    body.dark{--bg:#0b1220;--fg:#e5e7eb;--primary:#3b82f6;--primary-700:#60a5fa;--card:#0f172a;--mod:#0b2540;--index:#0b2540;--ok:#34d399;--warn:#f59e0b;}
  </style>
</head>
<body>
  <h1>C√°lculo de M√©dia Ponderada - M√≥dulos Acad√™micos</h1>
  <div class="toggle-theme"><button id="theme-toggle">üåû Alternar Modo Claro/Escuro üåô</button></div>

  <!-- √çndice -->
  <nav class="indice">
    <a href="#urgencia">Urg√™ncia e Emerg√™ncia</a>
    <a href="#processos">Processos Terap√™uticos I</a>
    <a href="#semiologia">Semiologia M√©dica I</a>
  </nav>

  <!-- M√ìDULO 1: URG√äNCIA E EMERG√äNCIA -->
  <section id="urgencia" class="modulo">
    <h2>Fundamentos da Urg√™ncia e Emerg√™ncia</h2>

    <div class="unidade"><h3>Unidade I</h3>
      <div class="grid">
        <label>1¬™ Avalia√ß√£o Te√≥rica (Peso 9)
          <input type="number" id="fu_u1_av1" min="0" max="10" step="0.1">
        </label>
        <label>Teste de Progresso (Peso 1)
          <input type="number" class="teste-progresso" id="fu_u1_tp" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade II</h3>
      <div class="grid">
        <label>2¬™ Avalia√ß√£o Te√≥rica (Peso 1)
          <input type="number" id="fu_u2_av1" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade III</h3>
      <div class="grid">
        <label>3¬™ Avalia√ß√£o OSPE (Peso 8)
          <input type="number" id="fu_u3_ospe" min="0" max="10" step="0.1">
        </label>
        <label>Atividades Processuais (Peso 2)
          <input type="number" id="fu_u3_proc" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade IV</h3>
      <div class="grid">
        <label>4¬™ Avalia√ß√£o Integrada (Peso 5)
          <input type="number" class="avaliacao-integrada" id="fu_u4_av1" min="0" max="10" step="0.1">
        </label>
        <label>Atividades Processuais (Peso 5)
          <input type="number" id="fu_u4_proc" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="actions">
      <button class="calc-btn" onclick="calcular('urgencia')">Calcular m√©dia Urg√™ncia e Emerg√™ncia</button>
      <button class="clear-btn" onclick="limparModulo('urgencia')">Limpar m√≥dulo</button>
    </div>
    <div class="resultado final" id="fu_final"></div>
    <div class="resultado mensagem warn" id="fu_mensagem"></div>
  </section>

  <!-- M√ìDULO 2: PROCESSOS TERAP√äUTICOS I -->
  <section id="processos" class="modulo">
    <h2>Processos Terap√™uticos I</h2>

    <div class="unidade"><h3>Unidade I</h3>
      <div class="grid">
        <label>Avalia√ß√£o Te√≥rica (Peso 9)
          <input type="number" id="pt_u1_av1" min="0" max="10" step="0.1">
        </label>
        <label>Teste de Progresso (Peso 1)
          <input type="number" class="teste-progresso" id="pt_u1_tp" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade II</h3>
      <div class="grid">
        <label>Avalia√ß√£o Te√≥rica (Peso 8)
          <input type="number" id="pt_u2_av1" min="0" max="10" step="0.1">
        </label>
        <label>Semin√°rios (Peso 2)
          <input type="number" id="pt_u2_sem" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade III</h3>
      <div class="grid">
        <label>Avalia√ß√£o Te√≥rica (Peso 8)
          <input type="number" id="pt_u3_av1" min="0" max="10" step="0.1">
        </label>
        <label>Semin√°rios (Peso 2)
          <input type="number" id="pt_u3_sem" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade IV</h3>
      <div class="grid">
        <label>Avalia√ß√£o Integrada (Peso 5)
          <input type="number" class="avaliacao-integrada" id="pt_u4_av1" min="0" max="10" step="0.1">
        </label>
        <label>Atividades Processuais (Peso 5)
          <input type="number" id="pt_u4_proc" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="actions">
      <button class="calc-btn" onclick="calcular('processos')">Calcular m√©dia Processos Terap√™uticos I</button>
      <button class="clear-btn" onclick="limparModulo('processos')">Limpar m√≥dulo</button>
    </div>
    <div class="resultado final" id="pt_final"></div>
    <div class="resultado mensagem warn" id="pt_mensagem"></div>
  </section>

  <!-- M√ìDULO 3: SEMIOLOGIA M√âDICA I -->
  <section id="semiologia" class="modulo">
    <h2>Semiologia M√©dica dos Sistemas I</h2>

    <div class="unidade"><h3>Unidade I</h3>
      <div class="grid">
        <label>Avalia√ß√£o Te√≥rica (ANM e ECTO) (Peso 7)
          <input type="number" id="sm_u1_av1" min="0" max="10" step="0.1">
        </label>
        <label>Semin√°rio Laborat√≥rio (Peso 2)
          <input type="number" id="sm_u1_sem" min="0" max="10" step="0.1">
        </label>
        <label>Teste de Progresso (Peso 1)
          <input type="number" class="teste-progresso" id="sm_u1_tp" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade II</h3>
      <div class="grid">
        <label>Avalia√ß√£o Te√≥rica (AR e ACV) (Peso 7)
          <input type="number" id="sm_u2_av1" min="0" max="10" step="0.1">
        </label>
        <label>Avalia√ß√£o Pr√°tica Anamnese (Peso 3)
          <input type="number" id="sm_u2_prat" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade III</h3>
      <div class="grid">
        <label>Avalia√ß√£o Te√≥rica (ABD e UR) (Peso 7)
          <input type="number" id="sm_u3_av1" min="0" max="10" step="0.1">
        </label>
        <label>Pr√°ticas Supervisionadas (Peso 1)
          <input type="number" id="sm_u3_prat" min="0" max="10" step="0.1">
        </label>
        <label>Semin√°rio Semiologia (Peso 2)
          <input type="number" id="sm_u3_sem" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="unidade"><h3>Unidade IV</h3>
      <div class="grid">
        <label>Avalia√ß√£o Integrada (Peso 5)
          <input type="number" class="avaliacao-integrada" id="sm_u4_av1" min="0" max="10" step="0.1">
        </label>
        <label>Avalia√ß√£o Pr√°tica OSCE (Peso 5)
          <input type="number" id="sm_u4_osce" min="0" max="10" step="0.1">
        </label>
      </div>
    </div>

    <div class="actions">
      <button class="calc-btn" onclick="calcular('semiologia')">Calcular m√©dia Semiologia M√©dica I</button>
      <button class="clear-btn" onclick="limparModulo('semiologia')">Limpar m√≥dulo</button>
    </div>
    <div class="resultado final" id="sm_final"></div>
    <div class="resultado mensagem warn" id="sm_mensagem"></div>
  </section>

  <script>
    // ======= Tema claro/escuro (autom√°tico + manual) =======
    const metaTheme=document.getElementById('theme-color-meta');
    const themeToggle=document.getElementById('theme-toggle');
    function applyTheme(dark){
      if(dark){document.body.classList.add('dark');metaTheme.setAttribute('content','#0b1220');localStorage.setItem('theme','dark');themeToggle.textContent='üåô Modo Escuro Ativo ‚Äî Alternar';}
      else{document.body.classList.remove('dark');metaTheme.setAttribute('content','#f9fafb');localStorage.setItem('theme','light');themeToggle.textContent='üåû Modo Claro Ativo ‚Äî Alternar';}
    }
    const mq=window.matchMedia('(prefers-color-scheme: dark)');
    const saved=localStorage.getItem('theme');
    if(saved)applyTheme(saved==='dark'); else applyTheme(mq.matches);
    mq.addEventListener('change',e=>{ if(!localStorage.getItem('theme')) applyTheme(e.matches); });
    themeToggle.addEventListener('click',()=>applyTheme(!document.body.classList.contains('dark')));

    // ======= Helpers =======
    function byId(id){return document.getElementById(id);} 
    function setMsgClass(el,ok){el.classList.remove('warn','ok');el.classList.add(ok?'ok':'warn');}

    // Uma unidade s√≥ √© "conclu√≠da" se **todas** as suas notas estiverem preenchidas (n√£o vazias)
    function unidadeConcluida(campos){
      return campos.every(c => c.el.value !== '' && !Number.isNaN(Number(c.el.value)));
    }

    // Calcula m√©dia ponderada de uma unidade (assume que est√° conclu√≠da)
    function mediaUnidade(campos){
      let soma=0, pesos=0; 
      for(const c of campos){ soma += Number(c.el.value) * c.peso; pesos += c.peso; }
      return pesos ? (soma/pesos) : 0;
    }

    // Resumo por m√≥dulo (parcial x final)
    function calcularModulo(prefix,titulo,unidadesDef){
      const finalEl=byId(prefix+'_final');
      const msgEl=byId(prefix+'_mensagem');

      const valores=[]; let completas=0; let soma=0;
      for(const def of unidadesDef){
        if(unidadeConcluida(def)){ const v=mediaUnidade(def); valores.push(v); soma+=v; completas++; }
        else { valores.push(''); }
      }

      if(completas < 4){
        finalEl.innerText='';
        const faltantes = 4 - completas; 
        const mediaParcial = completas ? (soma/completas) : 0;
        const faltam = Math.max(0, 28 - soma); // 7*4
        if(soma >= 28){ setMsgClass(msgEl,true); msgEl.innerText = `M√©dia parcial: ${mediaParcial.toFixed(2)} | Matematicamente aprovado ‚úÖ. Ainda restam ${faltantes} unidade(s) a lan√ßar.`; }
        else { setMsgClass(msgEl,false); msgEl.innerText = `M√©dia parcial: ${mediaParcial.toFixed(2)} | Faltam ${faltam.toFixed(2)} pontos para aprova√ß√£o. Ainda restam ${faltantes} unidade(s) a lan√ßar.`; }
      } else {
        msgEl.innerText='';
        const mediaFinal = soma / 4; 
        finalEl.innerText = `M√©dia Final ${titulo}: ${mediaFinal.toFixed(2)}`;
      }
    }

    function calcular(modulo){
      if(modulo==='urgencia'){
        calcularModulo('fu','Urg√™ncia e Emerg√™ncia', [
          [{el: fu_u1_av1, peso:9},{el: fu_u1_tp, peso:1}],
          [{el: fu_u2_av1, peso:1}],
          [{el: fu_u3_ospe, peso:8},{el: fu_u3_proc, peso:2}],
          [{el: fu_u4_av1, peso:5},{el: fu_u4_proc, peso:5}],
        ]);
      }
      if(modulo==='processos'){
        calcularModulo('pt','Processos Terap√™uticos I', [
          [{el: pt_u1_av1, peso:9},{el: pt_u1_tp, peso:1}],
          [{el: pt_u2_av1, peso:8},{el: pt_u2_sem, peso:2}],
          [{el: pt_u3_av1, peso:8},{el: pt_u3_sem, peso:2}],
          [{el: pt_u4_av1, peso:5},{el: pt_u4_proc, peso:5}],
        ]);
      }
      if(modulo==='semiologia'){
        calcularModulo('sm','Semiologia M√©dica dos Sistemas I', [
          [{el: sm_u1_av1, peso:7},{el: sm_u1_sem, peso:2},{el: sm_u1_tp, peso:1}],
          [{el: sm_u2_av1, peso:7},{el: sm_u2_prat, peso:3}],
          [{el: sm_u3_av1, peso:7},{el: sm_u3_prat, peso:1},{el: sm_u3_sem, peso:2}],
          [{el: sm_u4_av1, peso:5},{el: sm_u4_osce, peso:5}],
        ]);
      }
    }

    function limparModulo(moduloId){
      const sec = document.getElementById(moduloId);
      sec.querySelectorAll('input[type="number"]').forEach(i=>i.value='');
      const prefix = moduloId==='urgencia'?'fu':(moduloId==='processos'?'pt':'sm');
      byId(prefix+'_final').innerText='';
      const m = byId(prefix+'_mensagem'); m.innerText=''; m.classList.remove('ok'); m.classList.add('warn');
    }

    // ======= Sincroniza√ß√£o autom√°tica =======
    function syncByClass(cls){
      document.querySelectorAll('.'+cls).forEach(el=>{
        el.addEventListener('input',e=>{
          const val=e.target.value;
          document.querySelectorAll('.'+cls).forEach(i=>{ if(i!==e.target) i.value=val; });
        });
      });
    }
    syncByClass('avaliacao-integrada');
    syncByClass('teste-progresso');
  </script>
</body>
</html>
